/*
Pretty handling of time axes.

Set axis.mode to "time" to enable. See the section "Time series data" in API.txt
for details.
*/
(function(a){function c(a,b){return b*Math.floor(a/b)}function d(a,b,c,d){if(typeof a.strftime=="function")return a.strftime(b);var e=function(a,b){return a=""+a,b=""+(b==null?"0":b),a.length==1?b+a:a},f=[],g=!1,h=a.getHours(),i=h<12;c==null&&(c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),d==null&&(d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var j;h>12?j=h-12:h==0?j=12:j=h;for(var k=0;k<b.length;++k){var l=b.charAt(k);if(g){switch(l){case"a":l=""+d[a.getDay()];break;case"b":l=""+c[a.getMonth()];break;case"d":l=e(a.getDate());break;case"e":l=e(a.getDate()," ");break;case"H":l=e(h);break;case"I":l=e(j);break;case"l":l=e(j," ");break;case"m":l=e(a.getMonth()+1);break;case"M":l=e(a.getMinutes());break;case"S":l=e(a.getSeconds());break;case"y":l=e(a.getFullYear()%100);break;case"Y":l=""+a.getFullYear();break;case"p":l=i?"am":"pm";break;case"P":l=i?"AM":"PM";break;case"w":l=""+a.getDay()}f.push(l),g=!1}else l=="%"?g=!0:f.push(l)}return f.join("")}function e(a){function b(a,b,c,d){a[b]=function(){return c[d].apply(c,arguments)}}var c={date:a};a.strftime!=undefined&&b(c,"strftime",a,"strftime"),b(c,"getTime",a,"getTime"),b(c,"setTime",a,"setTime");var d=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"];for(var e=0;e<d.length;e++)b(c,"get"+d[e],a,"getUTC"+d[e]),b(c,"set"+d[e],a,"setUTC"+d[e]);return c}function f(a,b){if(b.timezone=="browser")return new Date(a);if(!b.timezone||b.timezone=="utc")return e(new Date(a));if(typeof timezoneJS!="undefined"&&typeof timezoneJS.Date!="undefined"){var c=new timezoneJS.Date;return c.setTimezone(b.timezone),c.setTime(a),c}return e(new Date(a))}function i(b){b.hooks.processDatapoints.push(function(b,e,i){a.each(b.getAxes(),function(a,b){var e=b.options;e.mode=="time"&&(b.tickGenerator=function(a){var b=[],d=f(a.min,e),i=0;e.minTickSize!=null&&(typeof e.tickSize=="number"?i=e.tickSize:i=e.minTickSize[0]*g[e.minTickSize[1]]);for(var j=0;j<h.length-1;++j)if(a.delta<(h[j][0]*g[h[j][1]]+h[j+1][0]*g[h[j+1][1]])/2&&h[j][0]*g[h[j][1]]>=i)break;var k=h[j][0],l=h[j][1];if(l=="year"){if(e.minTickSize!=null&&e.minTickSize[1]=="year")k=Math.floor(e.minTickSize[0]);else{var m=Math.pow(10,Math.floor(Math.log(a.delta/g.year)/Math.LN10)),n=a.delta/g.year/m;n<1.5?k=1:n<3?k=2:n<7.5?k=5:k=10,k*=m}k<1&&(k=1)}a.tickSize=e.tickSize||[k,l];var o=a.tickSize[0];l=a.tickSize[1];var p=o*g[l];l=="second"&&d.setSeconds(c(d.getSeconds(),o)),l=="minute"&&d.setMinutes(c(d.getMinutes(),o)),l=="hour"&&d.setHours(c(d.getHours(),o)),l=="month"&&d.setMonth(c(d.getMonth(),o)),l=="year"&&d.setFullYear(c(d.getFullYear(),o)),d.setMilliseconds(0),p>=g.minute&&d.setSeconds(0),p>=g.hour&&d.setMinutes(0),p>=g.day&&d.setHours(0),p>=g.day*4&&d.setDate(1),p>=g.year&&d.setMonth(0);var q=0,r=Number.NaN,s;do{s=r,r=d.getTime(),b.push(r);if(l=="month")if(o<1){d.setDate(1);var t=d.getTime();d.setMonth(d.getMonth()+1);var u=d.getTime();d.setTime(r+q*g.hour+(u-t)*o),q=d.getHours(),d.setHours(0)}else d.setMonth(d.getMonth()+o);else l=="year"?d.setFullYear(d.getFullYear()+o):d.setTime(r+p)}while(r<a.max&&r!=s);return b},b.tickFormatter=function(a,b){var c=f(a,b.options);if(e.timeformat!=null)return d(c,e.timeformat,e.monthNames,e.dayNames);var h=b.tickSize[0]*g[b.tickSize[1]],i=b.max-b.min,j=e.twelveHourClock?" %p":"",k=e.twelveHourClock?"%I":"%H";h<g.minute?fmt=k+":%M:%S"+j:h<g.day?i<2*g.day?fmt=k+":%M"+j:fmt="%b %d "+k+":%M"+j:h<g.month?fmt="%b %d":h<g.year?i<g.year?fmt="%b":fmt="%b %Y":fmt="%Y";var l=d(c,fmt,e.monthNames,e.dayNames);return l})})})}var b={},g={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:525949.2*60*1e3},h=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];a.plot.plugins.push({init:i,options:b,name:"time",version:"1.0"})})(jQuery);