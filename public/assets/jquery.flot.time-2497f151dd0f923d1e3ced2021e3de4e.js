/*
Pretty handling of time axes.

Set axis.mode to "time" to enable. See the section "Time series data" in API.txt
for details.
*/
(function(e){function n(e,t){return t*Math.floor(e/t)}function r(e,t,n,r){if(typeof e.strftime=="function")return e.strftime(t);var i=function(e,t){return e=""+e,t=""+(t==null?"0":t),e.length==1?t+e:e},s=[],o=!1,u=e.getHours(),a=u<12;n==null&&(n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),r==null&&(r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var f;u>12?f=u-12:u==0?f=12:f=u;for(var l=0;l<t.length;++l){var c=t.charAt(l);if(o){switch(c){case"a":c=""+r[e.getDay()];break;case"b":c=""+n[e.getMonth()];break;case"d":c=i(e.getDate());break;case"e":c=i(e.getDate()," ");break;case"H":c=i(u);break;case"I":c=i(f);break;case"l":c=i(f," ");break;case"m":c=i(e.getMonth()+1);break;case"M":c=i(e.getMinutes());break;case"S":c=i(e.getSeconds());break;case"y":c=i(e.getFullYear()%100);break;case"Y":c=""+e.getFullYear();break;case"p":c=a?"am":"pm";break;case"P":c=a?"AM":"PM";break;case"w":c=""+e.getDay()}s.push(c),o=!1}else c=="%"?o=!0:s.push(c)}return s.join("")}function i(e){function t(e,t,n,r){e[t]=function(){return n[r].apply(n,arguments)}}var n={date:e};e.strftime!=undefined&&t(n,"strftime",e,"strftime"),t(n,"getTime",e,"getTime"),t(n,"setTime",e,"setTime");var r=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"];for(var i=0;i<r.length;i++)t(n,"get"+r[i],e,"getUTC"+r[i]),t(n,"set"+r[i],e,"setUTC"+r[i]);return n}function s(e,t){if(t.timezone=="browser")return new Date(e);if(!t.timezone||t.timezone=="utc")return i(new Date(e));if(typeof timezoneJS!="undefined"&&typeof timezoneJS.Date!="undefined"){var n=new timezoneJS.Date;return n.setTimezone(t.timezone),n.setTime(e),n}return i(new Date(e))}function a(t){t.hooks.processDatapoints.push(function(t,i,a){e.each(t.getAxes(),function(e,t){var i=t.options;i.mode=="time"&&(t.tickGenerator=function(e){var t=[],r=s(e.min,i),a=0;i.minTickSize!=null&&(typeof i.tickSize=="number"?a=i.tickSize:a=i.minTickSize[0]*o[i.minTickSize[1]]);for(var f=0;f<u.length-1;++f)if(e.delta<(u[f][0]*o[u[f][1]]+u[f+1][0]*o[u[f+1][1]])/2&&u[f][0]*o[u[f][1]]>=a)break;var l=u[f][0],c=u[f][1];if(c=="year"){if(i.minTickSize!=null&&i.minTickSize[1]=="year")l=Math.floor(i.minTickSize[0]);else{var h=Math.pow(10,Math.floor(Math.log(e.delta/o.year)/Math.LN10)),p=e.delta/o.year/h;p<1.5?l=1:p<3?l=2:p<7.5?l=5:l=10,l*=h}l<1&&(l=1)}e.tickSize=i.tickSize||[l,c];var d=e.tickSize[0];c=e.tickSize[1];var v=d*o[c];c=="second"&&r.setSeconds(n(r.getSeconds(),d)),c=="minute"&&r.setMinutes(n(r.getMinutes(),d)),c=="hour"&&r.setHours(n(r.getHours(),d)),c=="month"&&r.setMonth(n(r.getMonth(),d)),c=="year"&&r.setFullYear(n(r.getFullYear(),d)),r.setMilliseconds(0),v>=o.minute&&r.setSeconds(0),v>=o.hour&&r.setMinutes(0),v>=o.day&&r.setHours(0),v>=o.day*4&&r.setDate(1),v>=o.year&&r.setMonth(0);var m=0,g=Number.NaN,y;do{y=g,g=r.getTime(),t.push(g);if(c=="month")if(d<1){r.setDate(1);var b=r.getTime();r.setMonth(r.getMonth()+1);var w=r.getTime();r.setTime(g+m*o.hour+(w-b)*d),m=r.getHours(),r.setHours(0)}else r.setMonth(r.getMonth()+d);else c=="year"?r.setFullYear(r.getFullYear()+d):r.setTime(g+v)}while(g<e.max&&g!=y);return t},t.tickFormatter=function(e,t){var n=s(e,t.options);if(i.timeformat!=null)return r(n,i.timeformat,i.monthNames,i.dayNames);var u=t.tickSize[0]*o[t.tickSize[1]],a=t.max-t.min,f=i.twelveHourClock?" %p":"",l=i.twelveHourClock?"%I":"%H";u<o.minute?fmt=l+":%M:%S"+f:u<o.day?a<2*o.day?fmt=l+":%M"+f:fmt="%b %d "+l+":%M"+f:u<o.month?fmt="%b %d":u<o.year?a<o.year?fmt="%b":fmt="%b %Y":fmt="%Y";var c=r(n,fmt,i.monthNames,i.dayNames);return c})})})}var t={},o={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:525949.2*60*1e3},u=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];e.plot.plugins.push({init:a,options:t,name:"time",version:"1.0"})})(jQuery);